<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Fraud Detection - Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* Base Styles */
        :root {
          --primary-color: #4361ee;
          --primary-dark: #3a0ca3;
          --danger-color: #f72585;
          --warning-color: #f8961e;
          --success-color: #2ecc71;
          --dark-color: #2c3e50;
          --light-color: #f5f7fa;
          --gray-color: #95a5a6;
          --white: #ffffff;
          --sidebar-width: 250px;
          --border-radius: 8px;
          --box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
          --transition: all 0.3s ease;
        }
        
        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
          background-color: var(--light-color);
          color: #333;
          line-height: 1.6;
        }
        
        /* Dashboard Layout */
        .dashboard-container {
          display: flex;
          min-height: 100vh;
        }
        
        /* Navigation Sidebar */
        .dashboard-nav {
          width: var(--sidebar-width);
          background-color: var(--dark-color);
          color: var(--white);
          padding: 20px 0;
          position: fixed;
          height: 100vh;
          transition: var(--transition);
          z-index: 100;
        }
        
        .nav-header {
          padding: 0 20px 20px;
          border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .nav-header h2 {
          display: flex;
          align-items: center;
          gap: 10px;
          font-size: 1.2rem;
          color: var(--white);
        }
        
        .nav-links {
          padding: 20px 0;
        }
        
        .nav-links a {
          display: flex;
          align-items: center;
          gap: 12px;
          padding: 12px 20px;
          color: rgba(255, 255, 255, 0.8);
          text-decoration: none;
          transition: var(--transition);
          font-size: 0.95rem;
        }
        
        .nav-links a:hover {
          background-color: rgba(255, 255, 255, 0.1);
          color: var(--white);
          padding-left: 25px;
        }
        
        .nav-links a.active {
          background-color: rgba(255, 255, 255, 0.1);
          color: var(--white);
          border-left: 3px solid var(--primary-color);
        }
        
        .nav-links a i {
          width: 20px;
          text-align: center;
          font-size: 1rem;
        }
        
        /* Main Content Area */
        .dashboard-content {
          flex: 1;
          padding: 30px;
          margin-left: var(--sidebar-width);
          transition: var(--transition);
        }
        
        .section-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 30px;
          flex-wrap: wrap;
          gap: 15px;
        }
        
        .section-header h2 {
          display: flex;
          align-items: center;
          gap: 12px;
          font-size: 1.8rem;
          color: var(--dark-color);
        }
        
        /* Buttons */
        .btn {
          padding: 10px 20px;
          border: none;
          border-radius: var(--border-radius);
          cursor: pointer;
          font-weight: 600;
          transition: var(--transition);
          display: inline-flex;
          align-items: center;
          gap: 8px;
          font-size: 0.95rem;
        }
        
        .btn-primary {
          background-color: var(--primary-color);
          color: var(--white);
        }
        
        .btn-primary:hover {
          background-color: var(--primary-dark);
          transform: translateY(-2px);
        }
        
        /* Alert List */
        .alert-list {
          background: var(--white);
          border-radius: var(--border-radius);
          box-shadow: var(--box-shadow);
          overflow: hidden;
        }
        
        .alert-item {
          display: grid;
          grid-template-columns: auto 1fr auto;
          align-items: center;
          padding: 15px 20px;
          border-bottom: 1px solid #eee;
          transition: var(--transition);
          gap: 15px;
        }
        
        .alert-item:last-child {
          border-bottom: none;
        }
        
        .alert-item:hover {
          background-color: rgba(67, 97, 238, 0.05);
        }
        
        .alert-icon {
          width: 40px;
          height: 40px;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 1.2rem;
        }
        
        .alert-icon.critical {
          background-color: rgba(247, 37, 133, 0.1);
          color: var(--danger-color);
        }
        
        .alert-icon.warning {
          background-color: rgba(248, 150, 30, 0.1);
          color: var(--warning-color);
        }
        
        .alert-icon.info {
          background-color: rgba(67, 97, 238, 0.1);
          color: var(--primary-color);
        }
        
        .alert-icon.resolved {
          background-color: rgba(46, 204, 113, 0.1);
          color: var(--success-color);
        }
        
        .alert-content {
          display: flex;
          flex-direction: column;
          gap: 5px;
        }
        
        .alert-title {
          font-weight: 600;
          color: var(--dark-color);
        }
        
        .alert-description {
          color: var(--gray-color);
          font-size: 0.9rem;
        }
        
        .alert-source {
          display: inline-block;
          font-size: 0.75rem;
          padding: 2px 6px;
          border-radius: 4px;
          background-color: #eee;
          color: #666;
          margin-top: 3px;
        }
        
        .alert-meta {
          display: flex;
          flex-direction: column;
          align-items: flex-end;
          gap: 5px;
        }
        
        .alert-time {
          font-size: 0.8rem;
          color: var(--gray-color);
          white-space: nowrap;
        }
        
        .alert-status {
          padding: 3px 8px;
          border-radius: 4px;
          font-size: 0.75rem;
          font-weight: 600;
          text-transform: uppercase;
        }
        
        .status-critical {
          background-color: var(--danger-color);
          color: white;
        }
        
        .status-warning {
          background-color: var(--warning-color);
          color: white;
        }
        
        .status-info {
          background-color: var(--primary-color);
          color: white;
        }
        
        .status-resolved {
          background-color: var(--success-color);
          color: white;
        }
        
        /* Empty State */
        .empty-state {
          text-align: center;
          padding: 40px 20px;
        }
        
        .empty-state i {
          font-size: 3rem;
          color: #ddd;
          margin-bottom: 15px;
        }
        
        .empty-state h3 {
          margin-bottom: 10px;
          color: #555;
        }
        
        .empty-state p {
          color: var(--gray-color);
          margin-bottom: 20px;
        }

        /* Alert Actions */
        .alert-actions {
          display: flex;
          gap: 10px;
          margin-top: 10px;
        }

        .alert-action-btn {
          background: none;
          border: none;
          color: var(--primary-color);
          font-size: 0.8rem;
          cursor: pointer;
          padding: 2px 5px;
          border-radius: 3px;
          transition: var(--transition);
        }

        .alert-action-btn:hover {
          background-color: rgba(67, 97, 238, 0.1);
        }

        .alert-action-btn.resolve {
          color: var(--success-color);
        }

        .alert-action-btn.ignore {
          color: var(--gray-color);
        }

        /* Alert Filters */
        .alert-filters {
          display: flex;
          gap: 10px;
          margin-bottom: 20px;
          flex-wrap: wrap;
        }

        .filter-btn {
          padding: 6px 12px;
          border-radius: 20px;
          font-size: 0.8rem;
          font-weight: 600;
          cursor: pointer;
          border: 1px solid #ddd;
          background: white;
          transition: var(--transition);
        }

        .filter-btn.active {
          background-color: var(--primary-color);
          color: white;
          border-color: var(--primary-color);
        }

        .filter-btn.critical {
          border-color: var(--danger-color);
          color: var(--danger-color);
        }

        .filter-btn.warning {
          border-color: var(--warning-color);
          color: var(--warning-color);
        }

        .filter-btn.info {
          border-color: var(--primary-color);
          color: var(--primary-color);
        }

        .filter-btn.resolved {
          border-color: var(--success-color);
          color: var(--success-color);
        }

        .filter-btn.active.critical {
          background-color: var(--danger-color);
        }

        .filter-btn.active.warning {
          background-color: var(--warning-color);
        }

        .filter-btn.active.info {
          background-color: var(--primary-color);
        }

        .filter-btn.active.resolved {
          background-color: var(--success-color);
        }

        /* Alert Summary */
        .alert-summary {
          display: flex;
          gap: 15px;
          margin-bottom: 20px;
          flex-wrap: wrap;
        }

        .summary-card {
          flex: 1;
          min-width: 150px;
          background: white;
          border-radius: var(--border-radius);
          padding: 15px;
          box-shadow: var(--box-shadow);
          display: flex;
          flex-direction: column;
          align-items: center;
        }

        .summary-card.critical {
          border-top: 3px solid var(--danger-color);
        }

        .summary-card.warning {
          border-top: 3px solid var(--warning-color);
        }

        .summary-card.info {
          border-top: 3px solid var(--primary-color);
        }

        .summary-card.resolved {
          border-top: 3px solid var(--success-color);
        }

        .summary-count {
          font-size: 1.8rem;
          font-weight: 700;
          margin: 5px 0;
        }

        .summary-count.critical {
          color: var(--danger-color);
        }

        .summary-count.warning {
          color: var(--warning-color);
        }

        .summary-count.info {
          color: var(--primary-color);
        }

        .summary-count.resolved {
          color: var(--success-color);
        }

        .summary-label {
          font-size: 0.8rem;
          color: var(--gray-color);
          text-transform: uppercase;
          letter-spacing: 1px;
        }

        /* AI Analysis Section */
        .ai-analysis-section {
          background: white;
          border-radius: var(--border-radius);
          box-shadow: var(--box-shadow);
          padding: 20px;
          margin-bottom: 30px;
        }

        .ai-analysis-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 15px;
        }

        .ai-analysis-header h3 {
          display: flex;
          align-items: center;
          gap: 10px;
          color: var(--dark-color);
        }

        .ai-analysis-content {
          display: flex;
          flex-direction: column;
          gap: 15px;
        }

        .message-type-tabs {
          display: flex;
          border-bottom: 1px solid #eee;
          margin-bottom: 15px;
        }

        .message-type-tab {
          padding: 8px 15px;
          cursor: pointer;
          border-bottom: 2px solid transparent;
          font-weight: 600;
          color: var(--gray-color);
          transition: var(--transition);
        }

        .message-type-tab.active {
          color: var(--primary-color);
          border-bottom-color: var(--primary-color);
        }

        .message-input-container {
          display: flex;
          gap: 10px;
        }

        .message-input {
          flex: 1;
          padding: 12px 15px;
          border: 1px solid #ddd;
          border-radius: var(--border-radius);
          font-size: 0.95rem;
          transition: var(--transition);
          min-height: 100px;
        }

        .message-input:focus {
          outline: none;
          border-color: var(--primary-color);
          box-shadow: 0 0 0 2px rgba(67, 97, 238, 0.2);
        }

        .ai-result {
          padding: 15px;
          border-radius: var(--border-radius);
          background-color: rgba(245, 247, 250, 0.5);
          border-left: 4px solid var(--primary-color);
        }

        .ai-result.critical {
          border-left-color: var(--danger-color);
          background-color: rgba(247, 37, 133, 0.05);
        }

        .ai-result.warning {
          border-left-color: var(--warning-color);
          background-color: rgba(248, 150, 30, 0.05);
        }

        .ai-result.verified {
          border-left-color: var(--success-color);
          background-color: rgba(46, 204, 113, 0.05);
        }

        .ai-result-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 10px;
        }

        .ai-result-title {
          font-weight: 600;
          color: var(--dark-color);
        }

        .ai-confidence {
          font-size: 0.8rem;
          color: var(--gray-color);
          font-style: italic;
        }

        .ai-result-details {
          font-size: 0.9rem;
          color: var(--dark-color);
        }

        .ai-result-reasons {
          margin-top: 10px;
          padding-left: 15px;
        }

        .ai-result-reason {
          font-size: 0.85rem;
          color: var(--gray-color);
          margin-bottom: 5px;
          position: relative;
        }

        .ai-result-reason:before {
          content: "•";
          position: absolute;
          left: -15px;
        }

        /* Loading State */
        .loading {
          display: inline-block;
          width: 20px;
          height: 20px;
          border: 3px solid rgba(67, 97, 238, 0.3);
          border-radius: 50%;
          border-top-color: var(--primary-color);
          animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
          .dashboard-nav {
            width: 70px;
            overflow: hidden;
          }
          
          .nav-header h2 span,
          .nav-links a span {
            display: none;
          }
          
          .nav-links a {
            justify-content: center;
            padding: 12px 0;
          }
          
          .dashboard-content {
            margin-left: 70px;
            padding: 20px;
          }
          
          .alert-item {
            grid-template-columns: auto 1fr;
          }
          
          .alert-meta {
            grid-column: span 2;
            flex-direction: row;
            justify-content: space-between;
            margin-top: 10px;
          }

          .alert-actions {
            grid-column: span 2;
            justify-content: flex-end;
          }

          .summary-card {
            min-width: calc(50% - 15px);
          }

          .message-input-container {
            flex-direction: column;
          }
        }
        
        @media (max-width: 480px) {
          .section-header {
            flex-direction: column;
            align-items: flex-start;
          }
          
          .alert-item {
            grid-template-columns: 1fr;
          }
          
          .alert-icon {
            margin-bottom: 10px;
          }
          
          .alert-meta {
            grid-column: span 1;
            margin-top: 10px;
          }

          .summary-card {
            min-width: 100%;
          }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Navigation Sidebar -->
        <nav class="dashboard-nav">
            <div class="nav-header">
                <h2><i class="fas fa-shield-alt"></i> <span>Security Dashboard</span></h2>
            </div>
            <div class="nav-links">
                <a href="dashboard.html">
                    <i class="fas fa-home"></i>
                    <span>Overview</span>
                </a>
                <a href="security-alerts.html" class="active">
                    <i class="fas fa-bell"></i>
                    <span>Security Alerts</span>
                </a>
                <a href="expense-tracker.html">
                    <i class="fas fa-wallet"></i>
                    <span>Expense Tracker</span>
                </a>
                <a href="budget-planner.html">
                    <i class="fas fa-chart-pie"></i>
                    <span>Budget Planner</span>
                </a>
                <a href="system-scan.html">
                    <i class="fas fa-search"></i>
                    System Scan
                </a>
                <a href="chatbot.html">
                    <i class="fas fa-robot"></i>
                    <span>AI Assistant</span>
                </a>
                <a href="settings.html">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </a>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="dashboard-content">
            <div class="security-overview">
                <div class="section-header">
                    <h2><i class="fas fa-bell"></i> Fraud Detection Alerts</h2>
                    <div class="action-buttons">
                        <button class="btn btn-primary">
                            <i class="fas fa-sync"></i> Refresh
                        </button>
                    </div>
                </div>

                <!-- AI Fraud Detection Section -->
                <div class="ai-analysis-section">
                    <div class="ai-analysis-header">
                        <h3><i class="fas fa-robot"></i> AI Fraud Detection</h3>
                    </div>
                    <div class="ai-analysis-content">
                        <div class="message-type-tabs">
                            <div class="message-type-tab active" data-type="transaction">Transaction</div>
                            <div class="message-type-tab" data-type="email">Email</div>
                            <div class="message-type-tab" data-type="app">App Message</div>
                        </div>
                        <div class="message-input-container">
                            <textarea class="message-input" placeholder="Paste a message to analyze for fraud..."></textarea>
                            <button class="btn btn-primary" id="analyze-btn">
                                <i class="fas fa-search"></i> Analyze
                            </button>
                        </div>
                        <div class="ai-result" id="ai-result" style="display: none;">
                            <div class="ai-result-header">
                                <span class="ai-result-title">Analysis Result</span>
                                <span class="ai-confidence" id="ai-confidence">90% confidence</span>
                            </div>
                            <div class="ai-result-details" id="ai-result-details">
                                This message appears to be legitimate.
                            </div>
                            <div class="ai-result-reasons" id="ai-result-reasons">
                                <div class="ai-result-reason">Contains valid contact information</div>
                                <div class="ai-result-reason">No urgent action demands</div>
                                <div class="ai-result-reason">Proper grammar and formatting</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="alert-summary">
                    <div class="summary-card critical">
                        <i class="fas fa-exclamation-circle"></i>
                        <div class="summary-count critical">0</div>
                        <div class="summary-label">Critical</div>
                    </div>
                    <div class="summary-card warning">
                        <i class="fas fa-exclamation-triangle"></i>
                        <div class="summary-count warning">0</div>
                        <div class="summary-label">Warning</div>
                    </div>
                    <div class="summary-card info">
                        <i class="fas fa-info-circle"></i>
                        <div class="summary-count info">0</div>
                        <div class="summary-label">Info</div>
                    </div>
                    <div class="summary-card resolved">
                        <i class="fas fa-check-circle"></i>
                        <div class="summary-count resolved">0</div>
                        <div class="summary-label">Resolved</div>
                    </div>
                </div>

                <div class="alert-filters">
                    <button class="filter-btn all active">All Alerts</button>
                    <button class="filter-btn critical">Critical</button>
                    <button class="filter-btn warning">Warning</button>
                    <button class="filter-btn info">Info</button>
                    <button class="filter-btn resolved">Resolved</button>
                </div>

                <div class="alert-list">
                    <!-- Alerts will be dynamically loaded here -->
                    <div class="empty-state">
                        <i class="fas fa-bell-slash fa-3x"></i>
                        <h3>No Security Alerts</h3>
                        <p>Your account security looks good!</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Security Monitoring Features
        const securityAlerts = {
            suspiciousLogin: false,
            unusualSpending: false,
            multipleFailedAttempts: false,
            newDeviceLogin: false
        };

        // DOM Elements
        const alertList = document.querySelector('.alert-list');
        const refreshBtn = document.querySelector('.btn-primary');
        const filterButtons = document.querySelectorAll('.filter-btn');
        const summaryCards = document.querySelectorAll('.summary-card');
        const analyzeBtn = document.getElementById('analyze-btn');
        const messageInput = document.querySelector('.message-input');
        const aiResult = document.getElementById('ai-result');
        const aiConfidence = document.getElementById('ai-confidence');
        const aiResultDetails = document.getElementById('ai-result-details');
        const aiResultReasons = document.getElementById('ai-result-reasons');
        const messageTypeTabs = document.querySelectorAll('.message-type-tab');

        // Current message type (transaction, email, app)
        let currentMessageType = 'transaction';

        // Initialize security monitoring
        initSecurityMonitoring();

        // Event Listeners
        refreshBtn.addEventListener('click', refreshAlerts);
        
        filterButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                filterButtons.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                filterAlerts(btn.classList.contains('all') ? 'all' : 
                              btn.classList.contains('critical') ? 'critical' :
                              btn.classList.contains('warning') ? 'warning' :
                              btn.classList.contains('info') ? 'info' : 'resolved');
            });
        });

        messageTypeTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                messageTypeTabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                currentMessageType = tab.getAttribute('data-type');
                messageInput.placeholder = getPlaceholderText(currentMessageType);
            });
        });

        analyzeBtn.addEventListener('click', analyzeMessage);

        // Functions
        function initSecurityMonitoring() {
            // Check for suspicious activity
            checkSuspiciousActivity();
            
            // Simulate periodic security checks (in a real app, this would be server-side)
            setInterval(checkSuspiciousActivity, 300000); // 5 minutes
            
            // Load initial alerts
            loadSecurityAlerts();
        }

        function getPlaceholderText(type) {
            switch(type) {
                case 'email':
                    return 'Paste a suspicious email to analyze for phishing...';
                case 'app':
                    return 'Paste a message from an app to verify its authenticity...';
                case 'transaction':
                default:
                    return 'Paste a bank/transaction message to verify...';
            }
        }

        function analyzeMessage() {
            const message = messageInput.value.trim();
            if (!message) return;

            // Show loading state
            analyzeBtn.innerHTML = '<div class="loading"></div> Analyzing...';
            analyzeBtn.disabled = true;

            // In a real app, this would call your backend API which would call the AI service
            // For demo purposes, we'll simulate the AI analysis
            setTimeout(() => {
                const result = simulateAIAnalysis(message, currentMessageType);
                displayAnalysisResult(result);
                
                // If the message is suspicious, create an alert
                if (result.verdict === 'critical' || result.verdict === 'warning') {
                    createAlert(
                        `Suspicious ${currentMessageType === 'email' ? 'Email' : currentMessageType === 'app' ? 'App Message' : 'Transaction'} Detected: ${result.title}`,
                        result.details,
                        result.verdict,
                        new Date(),
                        currentMessageType
                    );
                }
                
                // Reset button
                analyzeBtn.innerHTML = '<i class="fas fa-search"></i> Analyze';
                analyzeBtn.disabled = false;
            }, 1500);
        }

        function simulateAIAnalysis(message, type) {
            // Common phishing/fraud indicators
            const indicators = [
                // Generic indicators
                { pattern: /urgent|immediate|action required/i, weight: 0.3, desc: 'Urgency language' },
                { pattern: /click here|link|http|www\./i, weight: 0.4, desc: 'Suspicious link' },
                { pattern: /account suspended|locked/i, weight: 0.3, desc: 'Account threat' },
                { pattern: /verify your account/i, weight: 0.2, desc: 'Verification request' },
                { pattern: /unusual activity/i, weight: 0.2, desc: 'Suspicious activity claim' },
                { pattern: /dear customer|valued member/i, weight: 0.1, desc: 'Generic greeting' },
                { pattern: /password|login|credentials/i, weight: 0.3, desc: 'Credentials request' },
                { pattern: /\d{16}/, weight: 0.4, desc: 'Credit card number pattern' },
                { pattern: /[\u{1F600}-\u{1F64F}]/u, weight: 0.1, desc: 'Emojis in formal message' },
                
                // Email-specific indicators
                { pattern: /bank|paypal|amazon|apple/i, weight: type === 'email' ? 0.3 : 0.1, desc: 'Brand impersonation' },
                { pattern: /sender:.*@.*\.(ru|cn|info)/i, weight: type === 'email' ? 0.5 : 0, desc: 'Suspicious sender domain' },
                { pattern: /mismatched.*sender.*name/i, weight: type === 'email' ? 0.4 : 0, desc: 'Mismatched sender name' },
                
                // Transaction-specific indicators
                { pattern: /transaction.*failed.*resubmit/i, weight: type === 'transaction' ? 0.4 : 0.1, desc: 'Failed transaction request' },
                { pattern: /OTP|one time password/i, weight: type === 'transaction' ? 0.3 : 0.1, desc: 'OTP request' },
                { pattern: /refund.*overpayment/i, weight: type === 'transaction' ? 0.4 : 0.1, desc: 'Refund scam pattern' },
                
                // App-specific indicators
                { pattern: /update.*required.*immediately/i, weight: type === 'app' ? 0.5 : 0.1, desc: 'Fake update alert' },
                { pattern: /security.*alert.*click.*below/i, weight: type === 'app' ? 0.5 : 0.2, desc: 'Fake security alert' },
                { pattern: /your.*subscription.*expired/i, weight: type === 'app' ? 0.3 : 0.1, desc: 'Fake subscription alert' }
            ];

            // Calculate threat score
            let threatScore = 0;
            const matchedIndicators = [];
            
            indicators.forEach(indicator => {
                if (indicator.pattern.test(message)) {
                    threatScore += indicator.weight;
                    matchedIndicators.push({
                        description: indicator.desc,
                        weight: indicator.weight
                    });
                }
            });

            // Adjust score based on message type
            if (type === 'email') threatScore *= 1.2; // Emails are higher risk
            if (type === 'app') threatScore *= 1.1; // App messages are medium risk

            // Cap the score at 1
            threatScore = Math.min(threatScore, 1);

            // Determine verdict
            let verdict, title, confidence;
            if (threatScore > 0.7) {
                verdict = 'critical';
                title = 'High Risk Fraud Attempt';
                confidence = Math.floor(80 + (threatScore * 20));
            } else if (threatScore > 0.4) {
                verdict = 'warning';
                title = 'Potential Suspicious Message';
                confidence = Math.floor(60 + (threatScore * 20));
            } else {
                verdict = 'verified';
                title = 'Likely Legitimate Message';
                confidence = Math.floor(100 - (threatScore * 40));
            }

            // Generate details and reasons
            const details = threatScore > 0.4 
                ? `Our AI detected ${matchedIndicators.length} red flags indicating this might be fraudulent.`
                : 'This message appears to be legitimate with no strong indicators of fraud.';

            const reasons = matchedIndicators.length > 0
                ? matchedIndicators.map(ind => `${ind.description} (${Math.floor(ind.weight * 100)}% risk)`)
                : ['No suspicious patterns detected', 'Proper grammar and formatting', 'No urgent action demands'];

            return {
                verdict,
                title,
                details,
                reasons,
                confidence: `${confidence}%`,
                threatScore
            };
        }

        function displayAnalysisResult(result) {
            aiResult.style.display = 'block';
            aiResult.className = `ai-result ${result.verdict}`;
            aiConfidence.textContent = `${result.confidence} confidence`;
            aiResultDetails.textContent = result.details;
            
            // Clear previous reasons
            aiResultReasons.innerHTML = '';
            
            // Add new reasons
            result.reasons.forEach(reason => {
                const reasonElement = document.createElement('div');
                reasonElement.className = 'ai-result-reason';
                reasonElement.textContent = reason;
                aiResultReasons.appendChild(reasonElement);
            });
        }

        function checkSuspiciousActivity() {
            // In a real app, this would call your backend API
            // For demo purposes, we'll simulate some checks
            
            // 1. Check for multiple failed login attempts
            const failedAttempts = localStorage.getItem('failedLoginAttempts') || 0;
            if (failedAttempts >= 3) {
                securityAlerts.multipleFailedAttempts = true;
                createAlert(
                    'Multiple Failed Login Attempts', 
                    'There have been 3 or more failed login attempts to your account.',
                    'critical',
                    new Date(),
                    'system'
                );
            }

            // 2. Check for login from new device (simplified)
            const lastLoginDevice = localStorage.getItem('lastLoginDevice');
            const currentDevice = generateDeviceFingerprint();
            
            if (lastLoginDevice && lastLoginDevice !== currentDevice) {
                securityAlerts.newDeviceLogin = true;
                createAlert(
                    'Login From New Device', 
                    'Your account was accessed from a new device/browser.',
                    'warning',
                    new Date(),
                    'system'
                );
            }
            localStorage.setItem('lastLoginDevice', currentDevice);

            // 3. Check for unusual spending patterns (simplified)
            checkUnusualSpending();
        }

        function checkUnusualSpending() {
            const expenses = JSON.parse(localStorage.getItem('expenses')) || [];
            if (expenses.length === 0) return;

            // Get today's date and 7 days ago
            const today = new Date();
            const sevenDaysAgo = new Date(today);
            sevenDaysAgo.setDate(today.getDate() - 7);

            // Calculate average daily spending
            const lastWeekExpenses = expenses.filter(exp => {
                const expDate = new Date(exp.date);
                return expDate >= sevenDaysAgo && expDate <= today;
            });

            const totalSpent = lastWeekExpenses.reduce((sum, exp) => sum + exp.amount, 0);
            const avgDailySpend = totalSpent / 7;

            // Check for transactions 3x average
            const largeTransactions = expenses.filter(exp => {
                return exp.amount > (avgDailySpend * 3) && 
                       new Date(exp.date) >= sevenDaysAgo;
            });

            if (largeTransactions.length > 0) {
                securityAlerts.unusualSpending = true;
                createAlert(
                    'Unusual Spending Pattern', 
                    `Detected ${largeTransactions.length} unusually large transactions compared to your average spending.`,
                    'warning',
                    new Date(),
                    'transaction'
                );
            }
        }

        function loadSecurityAlerts() {
            // In a real app, this would fetch from your backend
            const alerts = JSON.parse(localStorage.getItem('securityAlerts')) || [];
            
            if (alerts.length === 0) {
                // Show empty state
                alertList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-bell-slash fa-3x"></i>
                        <h3>No Security Alerts</h3>
                        <p>Your account security looks good!</p>
                    </div>
                `;
                updateSummaryCounts({});
                return;
            }

            // Sort by newest first
            alerts.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            
            // Render alerts
            renderAlerts(alerts);
            updateSummaryCounts(alerts);
        }

        function renderAlerts(alerts) {
            alertList.innerHTML = '';
            
            alerts.forEach(alert => {
                const alertItem = document.createElement('div');
                alertItem.className = 'alert-item';
                alertItem.innerHTML = `
                    <div class="alert-icon ${alert.severity}">
                        <i class="fas ${getAlertIcon(alert.severity)}"></i>
                    </div>
                    <div class="alert-content">
                        <h4 class="alert-title">${alert.title}</h4>
                        <p class="alert-description">${alert.description}</p>
                        ${alert.source ? `<span class="alert-source">${alert.source}</span>` : ''}
                        <div class="alert-actions">
                            <button class="alert-action-btn resolve" data-id="${alert.timestamp}">
                                <i class="fas fa-check-circle"></i> Mark as Resolved
                            </button>
                            <button class="alert-action-btn ignore" data-id="${alert.timestamp}">
                                <i class="fas fa-times-circle"></i> Ignore
                            </button>
                        </div>
                    </div>
                    <div class="alert-meta">
                        <span class="alert-status status-${alert.severity}">${alert.severity}</span>
                        <span class="alert-time">${formatTime(alert.timestamp)}</span>
                    </div>
                `;
                alertList.appendChild(alertItem);
            });

            // Add event listeners to action buttons
            document.querySelectorAll('.alert-action-btn.resolve').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const alertId = e.target.closest('button').getAttribute('data-id');
                    markAlertAsResolved(alertId);
                });
            });

            document.querySelectorAll('.alert-action-btn.ignore').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const alertId = e.target.closest('button').getAttribute('data-id');
                    ignoreAlert(alertId);
                });
            });
        }

        function createAlert(title, description, severity, timestamp, source = 'system') {
            const alert = { 
                title, 
                description, 
                severity, 
                timestamp,
                source: source === 'transaction' ? 'Transaction' : 
                       source === 'email' ? 'Email' : 
                       source === 'app' ? 'App' : 'System'
            };
            
            // Save to localStorage (in a real app, this would be a backend API call)
            const alerts = JSON.parse(localStorage.getItem('securityAlerts')) || [];
            alerts.push(alert);
            localStorage.setItem('securityAlerts', JSON.stringify(alerts));
            
            // Refresh the display
            loadSecurityAlerts();
        }

        function markAlertAsResolved(alertId) {
            const alerts = JSON.parse(localStorage.getItem('securityAlerts')) || [];
            const updatedAlerts = alerts.map(alert => {
                if (alert.timestamp === alertId) {
                    return { ...alert, severity: 'resolved' };
                }
                return alert;
            });
            localStorage.setItem('securityAlerts', JSON.stringify(updatedAlerts));
            loadSecurityAlerts();
        }

        function ignoreAlert(alertId) {
            const alerts = JSON.parse(localStorage.getItem('securityAlerts')) || [];
            const updatedAlerts = alerts.filter(alert => alert.timestamp !== alertId);
            localStorage.setItem('securityAlerts', JSON.stringify(updatedAlerts));
            loadSecurityAlerts();
        }

        function filterAlerts(severity) {
            const alerts = JSON.parse(localStorage.getItem('securityAlerts')) || [];
            
            if (severity === 'all') {
                renderAlerts(alerts);
                return;
            }
            
            const filteredAlerts = alerts.filter(alert => alert.severity === severity);
            
            if (filteredAlerts.length === 0) {
                alertList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-bell-slash fa-3x"></i>
                        <h3>No ${severity} Alerts</h3>
                        <p>There are no ${severity} alerts to display.</p>
                    </div>
                `;
            } else {
                renderAlerts(filteredAlerts);
            }
        }

        function updateSummaryCounts(alerts) {
            const counts = {
                critical: 0,
                warning: 0,
                info: 0,
                resolved: 0
            };

            if (Array.isArray(alerts)) {
                alerts.forEach(alert => {
                    counts[alert.severity]++;
                });
            }

            summaryCards.forEach(card => {
                const type = card.classList.contains('critical') ? 'critical' :
                            card.classList.contains('warning') ? 'warning' :
                            card.classList.contains('info') ? 'info' : 'resolved';
                card.querySelector('.summary-count').textContent = counts[type];
            });
        }

        function refreshAlerts() {
            // Show loading state
            alertList.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-sync fa-spin fa-3x"></i>
                    <p>Checking for new alerts...</p>
                </div>
            `;
            
            // Simulate network request
            setTimeout(() => {
                checkSuspiciousActivity();
                loadSecurityAlerts();
            }, 1500);
        }

        // Helper Functions
        function generateDeviceFingerprint() {
            // Simplified fingerprint - in a real app you'd use a more robust solution
            return [
                navigator.userAgent,
                screen.width,
                screen.height,
                navigator.language
            ].join('|');
        }

        function getAlertIcon(severity) {
            switch(severity) {
                case 'critical': return 'fa-exclamation-circle';
                case 'warning': return 'fa-exclamation-triangle';
                case 'info': return 'fa-info-circle';
                default: return 'fa-check-circle';
            }
        }

        function formatTime(date) {
            return new Date(date).toLocaleString('en-US', {
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        // Simulate some initial alerts for demo purposes
        if (!localStorage.getItem('securityAlerts')) {
            createAlert(
                'Welcome to Fraud Detection', 
                'This is where you will see security alerts about potential fraud attempts.',
                'info',
                new Date(),
                'system'
            );
        }
    });
    </script>
</body>
</html>